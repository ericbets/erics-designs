#### Functional Databases

I like the idea of functional databases. In a nutshell that's making a database look like an rpc api using PL/PGSQL. Derek Sivers posted a [blog post](https://sivers.org/pg2) last year about it. I've did the same thing for a long time. Because I want my database to be loosely coupled to my code. 

But I don't do it always. After mulling it over a bit more I've realized that the reason I don't use PL/PGSQL 100% of the time is because I often want to support sqlite3 for easy data portability too. There is nothing quite like the ability to create or blow away a sqlite database with a simple `rm` command, especially when you are doing parallel distributed computation. It made think, what if there was a database local scripting language like PL/PGSQL that worked with both postgres & sqlite? SQLITE supports transactions so it shouldn't be too hard right? 

One practical way to achieve this in the short term would be to use knex.js on top of node-postgres or plv8 stored procedures for postgres and knex.js on top of itself for sqlite3. It might have a shot at being adopted by cloud vendors like CockroachDb, CitusData and Yugabyte. Their pitch could be: Just define a function header like `SELECT storeX(...)` or `SELECT queryZ(...)` and we'll make it span different geo regions, scale massively, run this fast, run on Mars etc etc. So perhaps they should consider funding something like this with a view towards creating a FAAS OLTP db local scripting standard. And if you as the customer don't have enterprise needs you just run it on your own infra, using your own database schemas and so on. A database portable local scripting PL/PGSQL alternative that's available by default is something that I as a database user would like to have.

Update: Just saw this [post](https://lucperkins.dev/blog/new-db-tech-1/) from Luc Perkins and learned about Prisma. Looks like you could generate a grpc schema from that prisma schema and that would be the right ordering to do it. So what I wrote about knex.js & stored procedures could be applied to prisma too. The thing missing at the moment and an important design consideration is having a convenient local scripting API while retaining access to the SQL interface if you need it.

